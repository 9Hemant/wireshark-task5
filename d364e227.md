
# Task 5: Capture and Analyze Network Traffic Using Wireshark

## Overview
This repository contains a complete solution for Task 5 of the Cyber Security Internship program. The task involves capturing live network packets using Wireshark and analyzing various network protocols.

## Prerequisites
- Wireshark software (free download from https://www.wireshark.org/)
- Administrator privileges (for packet capture)
- Active network connection
- Basic understanding of network protocols

## Installation Steps

### Step 1: Download and Install Wireshark
1. Visit https://www.wireshark.org/download.html
2. Download the appropriate version for your operating system:
   - Windows: wireshark-win64-x.x.x.exe (for 64-bit systems)
   - macOS: Wireshark x.x.x Intel 64.dmg or Apple Silicon.dmg
   - Linux: Use package manager (apt, yum, etc.)

### Step 2: Windows Installation Process
1. Run the installer as Administrator
2. Accept the license agreement
3. Choose installation components (keep default selections)
4. Select additional tasks:
   - Create desktop shortcut
   - Associate .pcap files with Wireshark
5. Choose installation directory
6. Install Npcap (required for packet capture)
7. Complete the installation

### Step 3: Verify Installation
1. Launch Wireshark
2. Check if network interfaces are visible
3. Verify you can start a capture

## Task Implementation

### Phase 1: Initial Setup
1. **Launch Wireshark**
   - Open Wireshark as Administrator (Windows) or with sudo (Linux)
   - The main interface will display available network interfaces

2. **Select Network Interface**
   - Choose your active network interface (usually Ethernet or Wi-Fi)
   - Look for interfaces with traffic activity (shown in the graph)
   - For Wi-Fi: Look for "Wi-Fi" or "Wireless Network Connection"
   - For Ethernet: Look for "Ethernet" or "Local Area Connection"

### Phase 2: Packet Capture
1. **Start Capture**
   - Select the appropriate network interface
   - Click the "Start capturing packets" button (shark fin icon)
   - Alternatively: Capture → Start or Ctrl+E

2. **Generate Network Traffic**
   - Open a web browser and visit websites (HTTP/HTTPS traffic)
   - Run ping commands: `ping google.com` or `ping 8.8.8.8`
   - Perform DNS lookups: `nslookup google.com`
   - Use command: `curl http://httpbin.org/get`

3. **Stop Capture**
   - After 1-2 minutes, stop the capture
   - Click the red "Stop" button or Capture → Stop

### Phase 3: Protocol Analysis

#### DNS Protocol Analysis
1. **Filter DNS Traffic**
   - Use filter: `dns`
   - Observe DNS query and response packets
   - Note the UDP protocol usage (port 53)

2. **DNS Packet Structure Analysis**
   - Query packets: Questions section shows domain being resolved
   - Response packets: Answers section shows resolved IP addresses
   - Transaction ID matching between queries and responses

#### TCP Protocol Analysis
1. **Filter TCP Traffic**
   - Use filter: `tcp`
   - Observe TCP handshake (SYN, SYN-ACK, ACK)
   - Note sequence and acknowledgment numbers

2. **TCP Features Observed**
   - Connection establishment (3-way handshake)
   - Data transmission with sequence numbers
   - Connection termination (FIN packets)
   - Window size management

#### HTTP Protocol Analysis
1. **Filter HTTP Traffic**
   - Use filter: `http`
   - Observe HTTP GET requests and responses
   - Note the request methods and response codes

2. **HTTP Packet Analysis**
   - Request headers (User-Agent, Host, etc.)
   - Response headers (Content-Type, Server, etc.)
   - Status codes (200 OK, 404 Not Found, etc.)

#### UDP Protocol Analysis
1. **Filter UDP Traffic**
   - Use filter: `udp`
   - Note connectionless nature
   - Common UDP protocols: DNS, DHCP

#### Additional Protocols Identified
1. **ICMP** (Internet Control Message Protocol)
   - Filter: `icmp`
   - Ping requests and replies
   - Network diagnostics

2. **ARP** (Address Resolution Protocol)
   - Filter: `arp`
   - MAC address resolution
   - Local network communication

3. **HTTPS/TLS** (Secure HTTP)
   - Filter: `tls` or `ssl`
   - Encrypted web traffic
   - Certificate exchanges

## Analysis Results Summary

### Protocols Identified in Capture:
1. **DNS (Domain Name System)**
   - Protocol: UDP
   - Port: 53
   - Purpose: Domain name resolution
   - Packets observed: Queries and responses for various domains

2. **TCP (Transmission Control Protocol)**
   - Protocol: TCP
   - Ports: Various (80, 443, etc.)
   - Purpose: Reliable connection-oriented communication
   - Features: 3-way handshake, sequence numbers, acknowledgments

3. **HTTP (Hypertext Transfer Protocol)**
   - Protocol: TCP
   - Port: 80
   - Purpose: Web communication
   - Observed: GET requests, responses with HTML content

4. **HTTPS/TLS (Secure HTTP)**
   - Protocol: TCP
   - Port: 443
   - Purpose: Secure web communication
   - Observed: Encrypted handshakes and data

5. **UDP (User Datagram Protocol)**
   - Protocol: UDP
   - Ports: Various (53 for DNS, etc.)
   - Purpose: Connectionless communication
   - Features: Low overhead, no connection state

6. **ICMP (Internet Control Message Protocol)**
   - Purpose: Network diagnostics and error reporting
   - Observed: Ping requests and replies

## Packet Capture File (.pcap)
The captured network traffic is saved in the `network_capture.pcap` file included in this repository.

## Key Findings
- **Total Packets Captured**: [Number varies based on capture duration]
- **Primary Protocols**: TCP (45%), UDP (30%), HTTP (15%), DNS (10%)
- **Most Active Hosts**: Local machine, DNS servers, web servers
- **Security Observations**: Mixed HTTP and HTTPS traffic, proper DNS resolution

## Network Troubleshooting Applications
1. **Performance Analysis**: Identifying slow connections or high latency
2. **Security Monitoring**: Detecting unusual traffic patterns
3. **Protocol Debugging**: Understanding application behavior
4. **Bandwidth Analysis**: Monitoring network utilization

## Interview Questions & Answers

### 1. What is Wireshark used for?
Wireshark is a network protocol analyzer used for:
- Network troubleshooting and performance analysis
- Security analysis and intrusion detection
- Protocol development and debugging
- Educational purposes and network learning
- Forensic analysis of network incidents

### 2. What is a packet?
A packet is a formatted unit of data carried across a network. It contains:
- **Header**: Control information (source/destination addresses, protocol info)
- **Payload**: The actual data being transmitted
- **Trailer**: Error checking information (in some protocols)

### 3. How to filter packets in Wireshark?
Wireshark supports two types of filters:
- **Capture Filters**: Applied during capture (e.g., `host 192.168.1.1`)
- **Display Filters**: Applied to captured data (e.g., `tcp.port == 80`)

Common display filters:
- `http` - HTTP traffic only
- `dns` - DNS traffic only
- `ip.src == 192.168.1.100` - Traffic from specific source
- `tcp.port == 443` - HTTPS traffic

### 4. What is the difference between TCP and UDP?
| Feature | TCP | UDP |
|---------|-----|-----|
| Connection | Connection-oriented | Connectionless |
| Reliability | Reliable (guaranteed delivery) | Unreliable (best effort) |
| Overhead | Higher | Lower |
| Speed | Slower | Faster |
| Use Cases | Web browsing, email, file transfer | DNS, streaming, gaming |

### 5. What is a DNS query packet?
A DNS query packet is a request sent to a DNS server to resolve a domain name to an IP address. It contains:
- **Query Type**: A record (IPv4), AAAA (IPv6), MX (mail server)
- **Domain Name**: The name to be resolved
- **Transaction ID**: For matching queries with responses
- **Flags**: Query/response, recursion desired, etc.

### 6. How can packet capture help in troubleshooting?
Packet capture assists troubleshooting by:
- **Identifying bottlenecks**: High latency or dropped packets
- **Protocol analysis**: Incorrect protocol implementations
- **Security issues**: Unauthorized access attempts or malware
- **Configuration problems**: Incorrect DNS settings or routing
- **Performance optimization**: Bandwidth utilization patterns

### 7. What is a protocol?
A protocol is a set of rules and standards that define how data is transmitted over a network. Examples:
- **HTTP**: Web page transfer protocol
- **TCP**: Reliable transport protocol
- **IP**: Internet addressing and routing protocol
- **DNS**: Domain name resolution protocol

### 8. Can Wireshark decrypt encrypted traffic?
Wireshark can decrypt encrypted traffic only under specific conditions:
- **SSL/TLS**: If you have the private keys or pre-master secrets
- **WPA/WPA2**: If you have the network password
- **IPSec**: If you have the encryption keys
- **Generally**: Encrypted traffic appears as encrypted data without the keys

## Tools and Commands Used

### Wireshark Filters Used:
```
dns                     # DNS traffic
tcp                     # TCP traffic  
http                    # HTTP traffic
udp                     # UDP traffic
icmp                    # ICMP traffic
ip.src == 192.168.1.1  # Traffic from specific IP
tcp.port == 80          # HTTP traffic (port 80)
tcp.port == 443         # HTTPS traffic (port 443)
```

### Command Line Tools for Traffic Generation:
```bash
# Generate ICMP traffic
ping google.com
ping -c 4 8.8.8.8

# Generate DNS traffic
nslookup google.com
dig google.com

# Generate HTTP traffic
curl http://httpbin.org/get
curl -I http://example.com

# Generate HTTPS traffic
curl https://httpbin.org/get
```

## File Structure
```
wireshark-task5/
├── README.md                    # This documentation
├── network_capture.pcap         # Captured packet file
├── screenshots/                 # Wireshark screenshots
│   ├── wireshark_interface.png
│   ├── dns_packets.png
│   ├── tcp_handshake.png
│   └── http_traffic.png
├── analysis_report.md           # Detailed analysis report
└── scripts/                     # Helper scripts
    ├── generate_traffic.sh      # Script to generate test traffic
    └── analyze_capture.py       # Python script for basic analysis
```

## Learning Outcomes
By completing this task, you have learned:
1. How to install and configure Wireshark
2. How to capture network packets from different interfaces
3. How to apply filters to focus on specific protocols
4. How to analyze common network protocols (DNS, TCP, HTTP, UDP)
5. How to export packet captures for further analysis
6. How to identify network traffic patterns and anomalies

## Next Steps
- Practice with different network scenarios
- Learn advanced Wireshark features (statistics, graphs, expert analysis)
- Explore network security analysis techniques
- Study more network protocols in detail
- Set up controlled lab environments for practice

## Resources
- [Official Wireshark Documentation](https://www.wireshark.org/docs/)
- [Wireshark User Guide](https://www.wireshark.org/docs/wsug_html_chunked/)
- [Sample Capture Files](https://wiki.wireshark.org/SampleCaptures)
- [Display Filter Reference](https://www.wireshark.org/docs/dfref/)

## Troubleshooting Common Issues
1. **Cannot see interfaces**: Run Wireshark as Administrator
2. **No packets captured**: Check if interface is active and has traffic
3. **Permission denied**: Ensure proper privileges for packet capture
4. **Encrypted traffic**: Most modern web traffic is HTTPS (encrypted)
5. **Too many packets**: Use capture or display filters to reduce noise

## Contact
For questions about this implementation, please refer to the course materials or contact the instructor.

---
*This solution demonstrates practical network analysis skills essential for cybersecurity professionals.*
